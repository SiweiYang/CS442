<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>17&nbsp;Q17 (posted Mar 17, due Apr 1)</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">CS 442 Assignment Questions</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Q1__posted_Jan_14__due_Jan_21_.html" class="tocviewlink" data-pltdoc="x">Q1 (posted Jan 14, due Jan 21)</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Q2__posted_Jan_14__due_Jan_31_.html" class="tocviewlink" data-pltdoc="x">Q2 (posted Jan 14, due Jan 31)</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Q3__posted_Jan_25__due_Feb_5_.html" class="tocviewlink" data-pltdoc="x">Q3 (posted Jan 25, due Feb 5)</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Q4__posted_Feb_3__due_Feb_10_.html" class="tocviewlink" data-pltdoc="x">Q4 (posted Feb 3, due Feb 10)</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Q5__posted_Feb_3__due_Feb_12_.html" class="tocviewlink" data-pltdoc="x">Q5 (posted Feb 3, due Feb 12)</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Q6__posted_Feb_3__due_Feb_14_.html" class="tocviewlink" data-pltdoc="x">Q6 (posted Feb 3, due Feb 14)</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Q7__posted_Feb_10__due_Feb_24_.html" class="tocviewlink" data-pltdoc="x">Q7 (posted Feb 10, due Feb 24)</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="Q8__posted_Feb_10__due_Feb_24_.html" class="tocviewlink" data-pltdoc="x">Q8 (posted Feb 10, due Feb 24)</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="Q9__posted_Feb_10__due_Feb_24_.html" class="tocviewlink" data-pltdoc="x">Q9 (posted Feb 10, due Feb 24)</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="Q10__posted_Feb_10__due_Feb_24_.html" class="tocviewlink" data-pltdoc="x">Q10 (posted Feb 10, due Feb 24)</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="Q11__posted_Mar_1__due_Mar_7_.html" class="tocviewlink" data-pltdoc="x">Q11 (posted Mar 1, due Mar 7)</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="Q12__posted_Mar_10__due_Mar_17_.html" class="tocviewlink" data-pltdoc="x">Q12 (posted Mar 10, due Mar 17)</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="Q13__posted_Mar_10__due_Mar_21_.html" class="tocviewlink" data-pltdoc="x">Q13 (posted Mar 10, due Mar 21)</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="Q14__posted_Mar_14__due_Mar_24_.html" class="tocviewlink" data-pltdoc="x">Q14 (posted Mar 14, due Mar 24)</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="Q15__posted_Mar_14__due_Mar_26_.html" class="tocviewlink" data-pltdoc="x">Q15 (posted Mar 14, due Mar 26)</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="Q16__posted_Mar_14__due_March_28_.html" class="tocviewlink" data-pltdoc="x">Q16 (posted Mar 14, due March 28)</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Q17 (posted Mar 17, due Apr 1)</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Q16__posted_Mar_14__due_March_28_.html" title="backward to &quot;16 Q16 (posted Mar 14, due March 28)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;CS 442 Assignment Questions&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3>17<tt>&nbsp;</tt><a name="(part._.Q17__posted_.Mar_17__due_.Apr_1_)"></a>Q17 (posted Mar 17, due Apr 1)</h3><script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><p><span style="font-weight: bold">Language:</span> Haskell.</p><p><span style="font-weight: bold">Weight:</span> 2.0</p><p>Adapt your Q13 solution to make the interpreted language lazy.
This involves generalizing <span class="stt">Closure</span> to <span class="stt">EClosure</span>, for
"expression closure". As an example, previously interpreting <span class="stt">Fun "x" (Var "x")</span>
with environment <span class="stt">e</span> would have resulted in <span class="stt">Closure "x" (Var "x") e</span>,
but now it results in <span class="stt">EClosure (Fun "x" (Var "x")) e</span>.
But the same is true of <span class="stt">BinApp Cons x y</span>, where <span class="stt">x</span> and <span class="stt">y</span>
are <span class="stt">Asts</span>, because <span class="stt">Cons</span> is lazy in both arguments.
All user-defined functions are lazy in their argument, as are
<span class="stt">Fst</span> and <span class="stt">Rst</span>. <span class="stt">IsEmpty</span> only evaluates its argument enough
to obtain the answer (so it can be applied to infinite lists). But
primitives operating on one or two numbers are strict (they need
to evaluate their arguments down to numbers). Here is the
new datatype:</p><p><table cellspacing="0"><tr><td><p><span class="stt">data Val = Number Integer | Truthy Bool | Empty</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| EClosure Ast Env deriving (Eq,Show)</span></p></td></tr></table></p><p>Note that a list <span class="stt">Val</span> must be represented as an <span class="stt">EClosure</span>.
Though an <span class="stt">EClosure</span> is showable, at the top level, the computation
in it should be completed (in other words, the REPL is strict).
This is also necessary because we shouldn&rsquo;t
show an <span class="stt">Env</span> containing a cycle (which was not a problem with Q13).</p><p>To solve this problem,
define <span class="stt">showVal :: Val -&gt; String</span> which completes the computation
in an <span class="stt">EClosure</span> (as well as showing the other possibilities for <span class="stt">Val</span>).
The string representation of a list within an <span class="stt">EClosure</span>
should be constructed using <span class="stt">[]</span>, <span class="stt">:</span>, and parentheses in the
usual way. For example, the equivalent of <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktVal">)</span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktVal">)</span> in Racket
would be shown as <span class="stt">"(1:2:[]):3:4:[]"</span>.
The string representation of a <span class="stt">Fun</span> within an <span class="stt">EClosure</span>
should be just <span class="stt">"&lt;fun&gt;"</span>.</p><p>Test expressions will be of the form <span class="stt">showVal $ interp exp []</span>.</p><p><span style="font-weight: bold">To submit:</span> <span class="stt">Q17.hs</span>.</p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Q16__posted_Mar_14__due_March_28_.html" title="backward to &quot;16 Q16 (posted Mar 14, due March 28)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;CS 442 Assignment Questions&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>